!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var i=e();for(var n in i)("object"==typeof exports?exports:t)[n]=i[n]}}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var s=i[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,e),s.l=!0,s.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,i){"use strict";L.TimelineVersion="1.0.0-beta",i(1),i(3)},function(t,e,i){"use strict";var n=function(t){return t&&t.__esModule?t:{default:t}}(i(2));L.Timeline=L.GeoJSON.extend({times:null,ranges:null,initialize:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.times=[],this.ranges=new n.default;L.GeoJSON.prototype.initialize.call(this,null,i),L.Util.setOptions(this,{drawOnSetTime:!0}),L.Util.setOptions(this,i),this.options.getInterval&&(this._getInterval=function(){var t;return(t=e.options).getInterval.apply(t,arguments)}),t&&this._process(t)},_getInterval:function(t){var e="start"in t.properties,i="end"in t.properties;return!(!e||!i)&&{start:new Date(t.properties.start).getTime(),end:new Date(t.properties.end).getTime()}},_process:function(t){var e=this,i=1/0,n=-1/0;t.features.forEach(function(t){var s=e._getInterval(t);s&&(e.ranges.insert(s.start,s.end,t),e.times.push(s.start),e.times.push(s.end),i=Math.min(i,s.start),n=Math.max(n,s.end))}),this.start=this.options.start||i,this.end=this.options.end||n,this.time=this.start,0!==this.times.length&&(this.times.sort(function(t,e){return t-e}),this.times=this.times.reduce(function(t,e,i){return 0===i?t:(t[t.length-1]!==e&&t.push(e),t)},[this.times[0]]))},setTime:function(t){this.time="number"==typeof t?t:new Date(t).getTime(),this.options.drawOnSetTime&&this.updateDisplayedLayers(),this.fire("change")},updateDisplayedLayers:function(){for(var t=this,e=this.ranges.lookup(this.time),i=0;i<this.getLayers().length;i++){for(var n=!1,s=this.getLayers()[i],r=0;r<e.length;r++)if(s.feature===e[r]){n=!0,e.splice(r,1);break}if(!n){var a=this.getLayers()[i--];this.removeLayer(a)}}e.forEach(function(e){return t.addData(e)})}}),L.timeline=function(t,e){return new L.Timeline(t,e)}},function(t,e,i){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=function t(e,i,n,r){s(this,t),this.low=e,this.high=i,this.min=e,this.max=i,this.data=n,this.left=null,this.right=null,this.parent=r},o=function(){function t(){s(this,t),this._root=null,this.size=0}return r(t,[{key:"_insert",value:function(t,e,i,n,s,r){var o=void 0;if(null===n)o=new a(t,e,i,s),null===s?this._root=o:s[r]=o;else{var h=t<n.low||t===n.low&&e<n.high?"left":"right";o=this._insert(t,e,i,n[h],n,h),n.max=Math.max(n.max,o.max),n.min=Math.min(n.min,o.min)}return o}},{key:"insert",value:function(t,e,i){this._insert(t,e,i,this._root,this._root),this.size++}},{key:"lookup",value:function(t){var e=[],i=this._root;return 2===arguments.length&&(i=arguments[1]),null===i||i.max<t?e:(e.push.apply(e,n(this.lookup(t,i.left))),i.low<=t&&(i.high>=t&&e.push(i.data),e.push.apply(e,n(this.lookup(t,i.right)))),e)}},{key:"overlap",value:function(t,e){var i=[],s=this._root;return 3===arguments.length&&(s=arguments[2]),t>s.high||s.low>e||i.push(s.data),s.left&&s.left.max>=t&&i.push.apply(i,n(this.overlap(t,e,s.left))),s.right&&s.right.min<=e&&i.push.apply(i,n(this.overlap(t,e,s.right))),i}}]),t}();e.default=o},function(t,e,i){"use strict";function n(t){if(Array.isArray(t)){for(var e=0,i=Array(t.length);e<t.length;e++)i[e]=t[e];return i}return Array.from(t)}L.TimelineSliderControl=L.Control.extend({initialize:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.timelines=[],L.Util.setOptions(this,{duration:1e4,enableKeyboardControls:!1,enablePlayback:!0,formatOutput:function(t){return""+(t||"")},showTicks:!0,waitToUpdateMap:!1,position:"bottomleft",steps:1e3,autoPlay:!1}),L.Util.setOptions(this,t),void 0!==t.start&&(this.start=t.start),void 0!==t.end&&(this.end=t.end)},_getTimes:function(){var t=this,e=[];if(this.timelines.forEach(function(i){var s=i.times.filter(function(e){return e>=t.start&&e<=t.end});e.push.apply(e,n(s))}),e.length){e.sort(function(t,e){return t-e});var i=[e[0]];return e.reduce(function(t,e){return t!==e&&i.push(e),e}),i}return e},_recalculate:function(){var t=void 0!==this.options.start,e=void 0!==this.options.end,i=this.options.duration,n=1/0,s=-1/0;this.timelines.forEach(function(t){t.start<n&&(n=t.start),t.end>s&&(s=t.end)}),t||(this.start=n,this._timeSlider.min=n===1/0?0:n,this._timeSlider.value=this._timeSlider.min),e||(this.end=s,this._timeSlider.max=s===-1/0?0:s),this._stepSize=Math.max(1,(this.end-this.start)/this.options.steps),this._stepDuration=Math.max(1,i/this.options.steps)},_nearestEventTime:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=this._getTimes(),n=!1,s=i[0],r=1;r<i.length;r++){var a=i[r];if(n)return a;if(a>=t){if(-1===e)return s;if(a!==t)return a;n=!0}s=a}return s},_createDOM:function(){var t=L.DomUtil.create("div",["leaflet-control-layers","leaflet-control-layers-expanded","leaflet-timeline-control"].join(" "));if(this.container=t,this.options.enablePlayback){var e=L.DomUtil.create("div","sldr-ctrl-container",t),i=L.DomUtil.create("div","button-container",e);this._makeButtons(i),this.options.enableKeyboardControls&&this._addKeyListeners(),this._makeOutput(e)}this._makeSlider(t),this.options.showTicks&&this._buildDataList(t),this.options.autoPlay&&this._autoPlay()},_autoPlay:function(){var t=this;"loading"==document.readyState?window.addEventListener("load",function(e){return t._autoPlay()}):this.play()},_addKeyListeners:function(){var t=this;this._listener=function(){return t._onKeydown.apply(t,arguments)},document.addEventListener("keydown",this._listener)},_removeKeyListeners:function(){document.removeEventListener("keydown",this._listener)},_buildDataList:function(t){this._datalist=L.DomUtil.create("datalist","",t);var e=Math.floor(1e6*Math.random());this._datalist.id="timeline-datalist-"+e,this._timeSlider.setAttribute("list",this._datalist.id),this._rebuildDataList()},_rebuildDataList:function(){for(var t=this._datalist;t.firstChild;)t.removeChild(t.firstChild);var e=L.DomUtil.create("select","",this._datalist);this._getTimes().forEach(function(t){L.DomUtil.create("option","",e).value=t})},_makeButton:function(t,e){var i=this,n=L.DomUtil.create("button",e,t);n.addEventListener("click",function(){return i[e]()}),L.DomEvent.disableClickPropagation(n)},_makeButtons:function(t){this._makeButton(t,"prev"),this._makeButton(t,"play"),this._makeButton(t,"pause"),this._makeButton(t,"next")},_disableMapDragging:function(){this.map.dragging.disable()},_enableMapDragging:function(){this.map.dragging.enable()},_makeSlider:function(t){var e=L.DomUtil.create("input","time-slider",t);e.type="range",e.min=this.start||0,e.max=this.end||0,e.value=this.start||0,this._timeSlider=e,L.DomEvent.on(this._timeSlider,"change input",this._sliderChanged,this),L.DomEvent.on(this._timeSlider,"pointerdown mousedown touchstart",this._disableMapDragging,this),L.DomEvent.on(document,"pointerup mouseup touchend",this._enableMapDragging,this)},_makeOutput:function(t){this._output=L.DomUtil.create("output","time-text",t),this._output.innerHTML=this.options.formatOutput(this.start)},_onKeydown:function(t){switch(t.keyCode||t.which){case 37:this.prev();break;case 39:this.next();break;case 32:this.toggle();break;default:return}t.preventDefault()},_sliderChanged:function(t){var e=parseFloat(+t.target.value,10);this.time=e,this.options.waitToUpdateMap&&"change"!==t.type||this.timelines.forEach(function(t){return t.setTime(e)}),this._output&&(this._output.innerHTML=this.options.formatOutput(e))},_resetIfTimelinesChanged:function(t){this.timelines.length!==t&&(this._recalculate(),this.options.showTicks&&this._rebuildDataList(),this.setTime(this.start))},addTimelines:function(){var t=this;this.pause();for(var e=this.timelines.length,i=arguments.length,n=Array(i),s=0;s<i;s++)n[s]=arguments[s];n.forEach(function(e){-1===t.timelines.indexOf(e)&&t.timelines.push(e)}),this._resetIfTimelinesChanged(e)},removeTimelines:function(){var t=this;this.pause();for(var e=this.timelines.length,i=arguments.length,n=Array(i),s=0;s<i;s++)n[s]=arguments[s];n.forEach(function(e){var i=t.timelines.indexOf(e);-1!==i&&t.timelines.splice(i,1)}),this._resetIfTimelinesChanged(e)},toggle:function(){this._playing?this.pause():this.play()},prev:function(){this.pause();var t=this._nearestEventTime(this.time,-1);this._timeSlider.value=t,this.setTime(t)},pause:function(t){clearTimeout(this._timer),this._playing=!1,this.container.classList.remove("playing"),this.syncedControl&&!t&&this.syncedControl.map(function(t){t.pause(!0)})},play:function(t){var e=this;clearTimeout(this._timer),parseFloat(this._timeSlider.value,10)===this.end&&(this._timeSlider.value=this.start),this._timeSlider.value=parseFloat(this._timeSlider.value,10)+this._stepSize,this.setTime(this._timeSlider.value),parseFloat(this._timeSlider.value,10)===this.end?(this._playing=!1,this.container.classList.remove("playing")):(this._playing=!0,this.container.classList.add("playing"),this._timer=setTimeout(function(){return e.play(!0)},this._stepDuration)),this.syncedControl&&!t&&this.syncedControl.map(function(t){t.play(!0)})},next:function(){this.pause();var t=this._nearestEventTime(this.time,1);this._timeSlider.value=t,this.setTime(t)},setTime:function(t){this._timeSlider&&(this._timeSlider.value=+t),this._sliderChanged({type:"change",target:{value:t}})},onAdd:function(t){return this.map=t,this._createDOM(),this.setTime(this.start),this.container},onRemove:function(){this.options.enableKeyboardControls&&this._removeKeyListeners(),L.DomEvent.off(this._timeSlider,"change input",this._sliderChanged,this),L.DomEvent.off(this._timeSlider,"pointerdown mousedown touchstart",this._disableMapDragging,this),L.DomEvent.off(document,"pointerup mouseup touchend",this._enableMapDragging,this),this._enableMapDragging()},syncControl:function(t){this.syncedControl||(this.syncedControl=[]),this.syncedControl.push(syncedControl)}}),L.timelineSliderControl=function(t,e,i,n){return new L.TimelineSliderControl(t,e,i,n)}}])});